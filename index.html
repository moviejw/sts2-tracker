<!doctype html>
<html lang="ko">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>슬더스2 트래커</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="assets/icons/favicon.png">
    <style>
        :root {
            --bg: #f6f8fb;
            --card: #ffffff;
            --muted: #6b7280;
            --accent: #5b8def;
            --radius: 12px;
            --shadow: 0 6px 22px rgba(15, 23, 42, 0.06);
            font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Noto Sans KR', 'Apple SD Gothic Neo', sans-serif;
        }

        * {
            box-sizing: border-box
        }

        body {
            margin: 0;
            background: var(--bg);
            color: #0f172a
        }

        .wrap {
            display: flex;
            min-height: 100vh
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            padding: 28px;
            background: linear-gradient(180deg, #ffffff, #fbfdff);
            border-right: 1px solid rgba(15, 23, 42, 0.04);
            height: calc(100vh - 0px);
            /* 화면 전체 높이 */
            position: sticky;
            top: 0;
            /* 상단에서 고정 */
            overflow-y: auto;
            /* 내용이 길어도 스크롤 가능 */
        }

        .brand {
            font-weight: 700;
            display: flex;
            gap: 10px;
            align-items: center
        }

        .logo {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--accent), #60d394);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: 700;
            overflow: hidden
        }

        nav {
            margin-top: 18px
        }

        nav a {
            display: block;
            padding: 10px 12px;
            border-radius: 8px;
            color: var(--muted);
            text-decoration: none;
            margin-bottom: 6px;
            transition: .15s
        }

        nav a.active,
        nav a:hover {
            background: rgba(91, 141, 239, 0.08);
            color: var(--accent)
        }

        /* Main */
        .main {
            flex: 1;
            padding: 28px
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px
        }

        h1 {
            margin: 0;
            font-size: 20px
        }

        .subtitle {
            color: var(--muted);
            font-size: 13px
        }

        .lang-toggle {
            background: var(--accent);
            color: #fff;
            border: none;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: .15s
        }

        .lang-toggle:hover {
            opacity: .9
        }

        .card {
            background: var(--card);
            padding: 18px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 16px
        }

        /* Grid */
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 14px
        }

        @media (max-width:980px) {
            .grid {
                grid-template-columns: repeat(2, 1fr)
            }
        }

        @media (max-width:640px) {
            .wrap {
                flex-direction: column
            }

            .sidebar {
                width: 100%;
                order: 2
            }

            .grid {
                grid-template-columns: 1fr
            }

            .main {
                order: 1
            }
        }

        /* 캐릭터 이미지 그리드 */
        .characters-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            /* 기본 2열 */
            gap: 16px;
        }

        .char-item img {
            width: 100%;
            height: auto;
            border-radius: 12px;
            object-fit: cover;
            cursor: pointer;
            box-shadow: 0 6px 22px rgba(15, 23, 42, 0.06);
            transition: transform 0.2s;
        }

        .char-item img:hover {
            transform: scale(1.03);
        }

        /* 반응형 */
        @media (max-width: 980px) {
            .characters-grid {
                grid-template-columns: 1fr;
                /* 모바일 1열 */
            }
        }

        /* Item card */
        .item {
            display: flex;
            gap: 14px;
            align-items: flex-start
        }

        .thumb {
            width: 180px;
            height: 180px;
            border-radius: 12px;
            background: rgba(242, 244, 248, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            flex-shrink: 0
        }

        .thumb img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            border-radius: 0px;
            background: transparent
        }

        :root {
            --card-color-red: #ffe5e5;
            --card-color-green: #e5ffe5;
            --card-color-blue: #e5e5ff;
            --card-color-purple: #f0e5ff;
            --card-color-gray: #f0f0f0;
        }


        .meta h3 {
            margin: 0;
            font-size: 16px
        }

        .meta p {
            margin: 8px 0 0;
            color: var(--muted);
            font-size: 14px
        }

        /* QnA */
        .qa dt {
            font-weight: 600;
            margin-top: 12px
        }

        .qa dd {
            margin: 6px 0 12px;
            color: var(--muted)
        }

        .muted {
            color: var(--muted);
            font-size: 13px
        }

        .empty {
            color: var(--muted);
            padding: 18px;
            text-align: center
        }
    </style>
</head>

<body>
    <div class="wrap">
        <aside class="sidebar">
            <div class="brand">
                <div class="logo">
                    <img src="assets/icons/icon.jpg" alt="S2 Logo" style="width:100%;height:100%;object-fit:cover;">
                </div>
                <div>
                    <div style="font-size:15px">슬더스2</div>
                    <div class="muted" style="font-size:12px">발매 전 정보</div>
                </div>
            </div>
            <nav>
                <a href="#overview" class="active">슬더스2</a>
                <a href="#characters">캐릭터</a>
                <a href="#cards">카드</a>
                <a href="#relics">유물</a>
                <a href="#release">출시일</a>
                <a href="#qna">Q & A</a>
            </nav>
            <button class="lang-toggle" id="langBtn" style="margin:12px 0;">원문 보기</button>
        </aside>

        <main class="main">
            <header>
                <div>
                    <h1>슬더스2 트래커</h1>
                    <div class="subtitle">대체 언제 출시함</div>
                </div>
            </header>

            <!-- Overview -->
            <section id="overview" class="card">
                <h2>슬더스2</h2>
                <p class="muted" id="overviewText">
                    슬더스2의 트레일러와 Neowsletter 등의 정보를 정리했습니다. 번역은 대부분 비공식 명칭이며, 모두 개발 중인 내용이므로 출시 시 변경될 수 있습니다. 정보에는 없지만
                    슬더스1에 있는 요소는 그대로 가져왔습니다.
                </p>
                <div style="margin-top:12px; display:flex; gap:12px; align-items:center;">
                    <a href="https://store.steampowered.com/app/2868840/Slay_the_Spire_2/" target="_blank"
                        style="text-decoration:none; color:var(--accent); display:flex; align-items:center; gap:6px;">
                        <img src="assets/icons/steam.png" alt="Steam" style="width:20px; height:20px;"> 스팀 페이지
                    </a>
                    <a href="https://www.megacrit.com/news/" target="_blank"
                        style="text-decoration:none; color:var(--accent); display:flex; align-items:center; gap:6px;">
                        <img src="assets/icons/megacrit.jpg" alt="Neowsletter" style="width:20px; height:20px;">
                        Neowsletter
                    </a>
                    <a href="https://www.youtube.com/watch?v=krDFltgjLtE" target="_blank"
                        style="text-decoration:none; color:var(--accent); display:flex; align-items:center; gap:6px;">
                        <img src="assets/icons/youtube.png" alt="Trailer" style="width:20px; height:20px;"> Reveal
                        Trailer
                    </a>
                    <a href="https://www.youtube.com/watch?v=ttVtllHkb4E" target="_blank"
                        style="text-decoration:none; color:var(--accent); display:flex; align-items:center; gap:6px;">
                        <img src="assets/icons/youtube.png" alt="Trailer" style="width:20px; height:20px;"> Gameplay
                        Trailer
                    </a>
                </div>
            </section>

            <section id="characters" class="card">
                <h2>캐릭터</h2>
                <div id="charactersGrid" class="grid characters-grid">
                    <div class="char-item">
                        <img src="assets/images/characters/ironclad.jpeg" alt="아클">
                    </div>
                    <div class="char-item">
                        <img src="assets/images/characters/silent.jpeg" alt="사일">
                    </div>
                    <div class="char-item">
                        <img src="assets/images/characters/necrobinder.jpeg" alt="샌즈">
                    </div>
                    <div class="char-item">
                        <img src="assets/images/characters/defecter.jpeg" alt="디펙터">
                    </div>
                </div>
            </section>

            <!-- Cards -->
            <section id="cards" class="card">
                <h2>카드</h2>
                <div id="cardsGrid" class="grid"></div>
            </section>

            <!-- Relics -->
            <section id="relics" class="card">
                <h2>유물</h2>
                <div id="relicsGrid" class="grid"></div>
            </section>

            <section id="release" class="card">
                <h2>출시일</h2>
                <div id="highlightRelease" style="margin-top:12px;"></div>
                <ul id="releaseList" style="margin-bottom:16px;"></ul>
                <div><a href="https://www.reddit.com/r/slaythespire/comments/1moeo4q/slay_the_spire_2_11_possible_release_dates/"
                        target="_blank"
                        style="text-decoration:none;color:var(--accent); display:flex; align-items:center; gap:6px;">
                        <img src="assets/icons/reddit.png" alt="Reddit" style="width:20px; height:20px;">출시일
                        정보</a></div>
            </section>

            <!-- QnA -->
            <section id="qna" class="card">
                <h2>Q &amp; A</h2>
                <dl class="qa" id="qaList"></dl>
            </section>
        </main>
    </div>
    <div id="imageModal"
        style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.7); align-items:center; justify-content:center; z-index:1000;">
        <img id="modalImg" src="" alt=""
            style="max-width:90%; max-height:90%; border-radius:0px; box-shadow:0 8px 30px rgba(0,0,0,0.4);">
    </div>


    <script>
        let currentLang = 'kr';
        let DB = { cards: [], relics: [], qa: [] };

        async function loadJSON(path) {
            const res = await fetch(path);
            if (!res.ok) throw new Error(`Failed to load ${path}`);
            return await res.json();
        }

        async function loadAllData() {
            try {
                const [cards, relics, qa] = await Promise.all([
                    loadJSON("assets/db/cards.json"),
                    loadJSON("assets/db/relics.json"),
                    loadJSON("assets/db/qnas.json")
                ]);
                DB.cards = cards;
                DB.relics = relics;
                DB.qa = qa;
                renderAll();
            } catch (e) {
                console.error(e);
            }
        }

        function renderCards(list) {
            const grid = document.getElementById('cardsGrid');
            grid.innerHTML = '';

            if (list.length === 0) {
                grid.innerHTML = '<div class="empty">카드가 없습니다.</div>';
                return;
            }

            for (const c of list) {
                const el = document.createElement('div');
                el.className = 'card item';

                let bgColor = '';
                switch (c.color?.toLowerCase()) {
                    case '아이언클래드': bgColor = 'var(--card-color-red)'; break;
                    case '사일런트': bgColor = 'var(--card-color-green)'; break;
                    case '디펙트': bgColor = 'var(--card-color-blue)'; break;
                    case '네크로바인더': bgColor = 'var(--card-color-purple)'; break;
                    default: bgColor = 'var(--card-color-gray)';
                }
                el.style.background = bgColor;

                const name = currentLang === 'kr' ? c.name_kr : c.name_en;
                const desc = currentLang === 'kr' ? c.description_kr : c.description_en;

                el.innerHTML = `
            <div class="thumb"><img src="assets/images/cards/${c.image}" alt="${name}"></div>
            <div class="meta">
                <h3>${name} <span class="muted" style="font-size:12px">· ${c.type} · ${c.rarity} · ${c.cost}코스트</span></h3>
                <p>${desc}</p>
            </div>`;
                grid.appendChild(el);
            }
        }

        function renderRelics(list) {
            const grid = document.getElementById('relicsGrid'); grid.innerHTML = '';
            if (list.length === 0) { grid.innerHTML = '<div class="empty">유물이 없습니다.</div>'; return }
            for (const r of list) {
                const el = document.createElement('div'); el.className = 'card item';
                const name = currentLang === 'kr' ? r.name_kr || r.name : r.name_en || r.name;
                const desc = currentLang === 'kr' ? r.desc_kr || r.desc : r.desc_en || r.desc;
                el.innerHTML = `
          <div class="thumb"><img src="assets/relics/${r.image}" alt="${name}"></div>
          <div class="meta"><h3>${name}</h3><p>${desc}</p></div>`;
                grid.appendChild(el);
            }
        }

        function renderReleaseDates() {
            const releaseDates = [
                '2025-08-28',
                '2025-09-04',
                '2025-09-18',
                '2025-09-25',
                '2025-10-02',
                '2025-10-09',
                '2025-10-16',
                '2025-10-23',
                '2025-11-06',
                '2025-11-13',
                '2025-11-20',
                '2025-11-27'
            ].map(d => new Date(d));

            const today = new Date();
            today.setHours(0, 0, 0, 0);

            const futureDates = releaseDates.filter(d => d >= today);
            const nearest = futureDates.length ? futureDates[0] : null;
            const farthest = futureDates.length ? futureDates[futureDates.length - 1] : null;

            const highlightDiv = document.getElementById('highlightRelease');
            highlightDiv.innerHTML = '';

            if (nearest) {
                const diffDays = Math.ceil((nearest - today) / (1000 * 60 * 60 * 24));
                const div = document.createElement('div');
                div.style.fontSize = '18px';
                div.style.fontWeight = '600';
                div.style.marginBottom = '6px';
                div.textContent = `가장 가까운 출시일까지 D-${diffDays}`;
                highlightDiv.appendChild(div);
            }

            if (farthest) {
                const diffDays = Math.ceil((farthest - today) / (1000 * 60 * 60 * 24));
                const div = document.createElement('div');
                div.style.fontSize = '18px';
                div.style.fontWeight = '600';
                div.textContent = `가장 먼 출시일까지 D-${diffDays}`;
                highlightDiv.appendChild(div);
            }

            const list = document.getElementById('releaseList');
            list.innerHTML = '';
            futureDates.forEach(d => {
                const li = document.createElement('li');
                li.textContent = d.toLocaleDateString('ko-KR', { month: 'long', day: 'numeric' });
                list.appendChild(li);
            });
        }


        function renderQA(list) {
            const dl = document.getElementById('qaList'); dl.innerHTML = '';
            if (list.length === 0) { dl.innerHTML = '<div class="empty">Q&amp;A 목록이 비어있습니다.</div>'; return }
            for (const qa of list) {
                const q = currentLang === 'kr' ? qa.q_kr || qa.q : qa.q_en || qa.q;
                const a = currentLang === 'kr' ? qa.a_kr || qa.a : qa.a_en || qa.a;
                const dt = document.createElement('dt'); dt.textContent = q;
                const dd = document.createElement('dd'); dd.textContent = a;
                dl.appendChild(dt); dl.appendChild(dd);
            }
        }

        function sortCards(cards) {
            const colorOrder = {
                '아이언클래드': 0,
                '사일런트': 1,
                '네크로바인더': 2,
                '디펙트': 3,
                '무색': 4
            };

            const typeOrder = {
                '공격': 0,
                '스킬': 1,
                '파워': 2
            };

            const rarityOrder = {
                '시작': 0,
                '일반': 1,
                '특별': 2,
                '희귀': 3
            };

            return cards.slice().sort((a, b) => {
                const colorA = colorOrder[a.color] ?? 99;
                const colorB = colorOrder[b.color] ?? 99;
                if (colorA !== colorB) return colorA - colorB;

                const typeA = typeOrder[a.type] ?? 99;
                const typeB = typeOrder[b.type] ?? 99;
                if (typeA !== typeB) return typeA - typeB;

                const rarityA = rarityOrder[a.rarity] ?? 99;
                const rarityB = rarityOrder[b.rarity] ?? 99;
                if (rarityA !== rarityB) return rarityA - rarityB;

                return 0;
            });
        }

        const modal = document.getElementById('imageModal');
        const modalImg = document.getElementById('modalImg');

        function addImagePopup() {
            document.querySelectorAll('.item .thumb img').forEach(img => {
                img.style.cursor = 'pointer';
                img.addEventListener('click', () => {
                    modal.style.display = 'flex';
                    modalImg.src = img.src;
                    modalImg.alt = img.alt;
                });
            });
        }

        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.style.display = 'none';
                modalImg.src = '';
            }
        });

        function renderAll() {
            const sortedCards = sortCards(DB.cards);
            renderCards(sortedCards);
            //renderRelics(DB.relics);
            renderReleaseDates();
            //renderQA(DB.qa);
            addImagePopup();
        }

        document.getElementById('langBtn').addEventListener('click', () => {
            currentLang = currentLang === 'kr' ? 'en' : 'kr';
            document.getElementById('langBtn').textContent = currentLang === 'kr' ? '원문 보기' : '한국어';
            renderAll();
        });

        loadAllData();

        document.querySelectorAll('nav a').forEach(a => {
            a.addEventListener('click', () => {
                document.querySelectorAll('nav a').forEach(x => x.classList.remove('active'))
                a.classList.add('active')
            })
        });
    </script>
</body>

</html>